{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.js"],"names":["cc","Class","extends","Component","properties","level","floodPrefab","default","type","Prefab","canvas","Node","move_display","Label","scoreAudio","AudioClip","mode_label","setting_pan","result_pan","btn_restart","btn_friend","lbl_result_title","cup_success","cup_failed","lbl_score","lbl_resul_moves","btn_pause","Sprite","spawnInterval","onLoad","spawnCount","name","rows","limit","actions","events","initialize","create_table","score","finished","game_level","game_successed","colours","Color","BLUE","RED","GREEN","YELLOW","ORANGE","MAGENTA","marginX","marginy","change_level","comein_panAction","moveBy","v2","easing","easeCubicActionOut","comeout_panAction","goout_pan","lobbyAppearAction1","easeElasticOut","lobbyAppearAction2","lobbyAppearAction3","lobbyAppearAction4","lobbyAppearRestart","lobbyAppearFriend","lobbyDisAppearAction1","lobbyDisAppearAction2","lobbyDisAppearAction3","lobbyDisAppearAction4","lobbyDisAppearRestart","lobbyDisAppearFriend","on","EventType","MOUSE_DOWN","out_result_pan_restart","in_result_pan","b_result","zIndex","node","runAction","sequence","fadeOut","delayTime","callFunc","callback_result_in","bind","fadeIn","callback_result_out","string","restart_game","clear_node","row","col","removeChild","game_table","element","destroy","reset_table","numberToSpawn","start_table","colour","flooded","num","limit_moves","level_name","moves","updateMoves","random_colour","colour_no","Math","floor","random","flood_element","color","flood_neighbours","test_colour_flood","equals","all_flooded","flood","initial","old_colour","star","spawnNewStarByNum","setSpawnCordinate","i","j","inum","newcolour","newStar","instantiate","addChild","starWidth","width","height","x","y","pos","setPosition","spawnNewStar","getNewStarPosition","ynum","parseInt","new_game","gainScore","gameOver","director","loadScene"],"mappings":"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","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        level:[],\r\n        floodPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        canvas: {\r\n            default: null,\r\n            type: cc.Node\r\n        },              \r\n        move_display: {\r\n            default: null,\r\n            type: cc.Label\r\n        },       \r\n        scoreAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        mode_label: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        setting_pan: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        result_pan: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        btn_restart: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        btn_friend: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        lbl_result_title: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        cup_success: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        cup_failed: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        lbl_score: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        lbl_resul_moves: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        btn_pause: {\r\n            default: null,\r\n            type: cc.Sprite\r\n        },\r\n        spawnInterval: 0,        \r\n    },\r\n\r\n    onLoad: function () { \r\n        \r\n        this.spawnCount = 0;       \r\n        this.level = \r\n        [\r\n            {   name: \"Normal\",  rows:3, limit: 18 },\r\n            {   name: \"Hard\",    rows:12, limit: 24 },\r\n            {   name: \"Hell\",    rows:18, limit: 31 },\r\n            {   name: \"Extreme\", rows:24, limit: 41 }\r\n        ];\r\n        \r\n        this.actions();\r\n        this.events();        \r\n \r\n        this.initialize();\r\n        this.create_table();        \r\n        this.score = 0;\r\n    },\r\n\r\n    initialize: function()\r\n    {\r\n        this.finished = false;\r\n        this.game_level = 0;\r\n        this.game_successed = false;\r\n        this.colours = [cc.Color.BLUE, cc.Color.RED,cc.Color.GREEN,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.MAGENTA];        \r\n        this.marginX = 50;\r\n        this.marginy = 180;\r\n\r\n        this.change_level(this.game_level);\r\n    },\r\n\r\n    actions: function()\r\n    {\r\n        this.comein_panAction = cc.moveBy(0.5, cc.v2(320, 0)).easing(cc.easeCubicActionOut());\r\n        this.comeout_panAction = cc.moveBy(0.5, cc.v2(-320, 0)).easing(cc.easeCubicActionOut());\r\n        this.goout_pan = cc.moveBy(0.5, cc.v2(-640, 0)).easing(cc.easeCubicActionOut());\r\n\r\n        //Appear Result Pan\r\n        this.lobbyAppearAction1 = cc.moveBy(0.7, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearAction2 = cc.moveBy(0.6, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearAction3 = cc.moveBy(0.5, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearAction4 = cc.moveBy(0.4, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n\r\n        this.lobbyAppearRestart = cc.moveBy(0.2, cc.v2(320, 0)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearFriend = cc.moveBy(0.1, cc.v2(320, 0)).easing(cc.easeElasticOut());  \r\n        \r\n        //Disapper Result Pan\r\n        this.lobbyDisAppearAction1 = cc.moveBy(0.7, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearAction2 = cc.moveBy(0.6, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearAction3 = cc.moveBy(0.5, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearAction4 = cc.moveBy(0.4, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n\r\n        this.lobbyDisAppearRestart = cc.moveBy(0.2, cc.v2(-320, 0)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearFriend = cc.moveBy(0.1, cc.v2(-320, 0)).easing(cc.easeElasticOut());\r\n    },\r\n\r\n    events: function()\r\n    {\r\n        this.btn_restart.on(cc.Node.EventType.MOUSE_DOWN, function () {            \r\n            this.out_result_pan_restart();                   \r\n        }, this);\r\n\r\n        this.btn_friend.on(cc.Node.EventType.MOUSE_DOWN, function () {            \r\n            // web service                   \r\n        }, this);\r\n    },\r\n\r\n    in_result_pan: function(b_result)\r\n    {\r\n        this.setting_pan.zIndex = 3;\r\n        this.btn_pause.node.runAction(cc.sequence(\r\n            cc.fadeOut(0.7),\r\n            cc.delayTime(0.1)\r\n        ));\r\n        this.result_pan.runAction(cc.sequence(\r\n            cc.moveBy(0.3, cc.v2(320, 0)),\r\n            this.comein_panAction, \r\n            cc.callFunc(this.callback_result_in.bind(this))\r\n        )); \r\n    },\r\n\r\n    out_result_pan_restart: function()\r\n    { \r\n        this.btn_pause.node.runAction(cc.sequence(\r\n            cc.fadeIn(1.5),\r\n            cc.delayTime(0.1)\r\n        ));\r\n        if(this.game_successed)           \r\n        {\r\n            this.cup_success.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, 280)), this.lobbyDisAppearAction2));\r\n        }    \r\n        else\r\n        {\r\n            this.cup_failed.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, 280)), this.lobbyDisAppearAction2));\r\n        }\r\n        this.lbl_result_title.node.runAction(cc.sequence(\r\n            cc.moveBy(0.7, cc.v2(0, 280)),\r\n            this.lobbyDisAppearAction1,\r\n            cc.callFunc(this.callback_result_out.bind(this))\r\n        ));\r\n        this.lbl_score.node.runAction(cc.sequence(cc.moveBy(0.5, cc.v2(0, 280)), this.lobbyDisAppearAction3));\r\n        this.lbl_resul_moves.node.runAction(cc.sequence(cc.moveBy(0.4, cc.v2(0, 280)), this.lobbyDisAppearAction4));        \r\n\r\n        this.btn_restart.runAction(cc.sequence(cc.moveBy(0.2, cc.v2(-320, 0)), this.lobbyDisAppearRestart));\r\n        this.btn_friend.runAction(cc.sequence(cc.moveBy(0.1, cc.v2(-320, 0)), this.lobbyDisAppearFriend));\r\n\r\n    },\r\n\r\n    callback_result_in: function()\r\n    {\r\n        if(this.game_successed)           \r\n        {\r\n            this.lbl_result_title.string = \"PASS\";\r\n            this.cup_success.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, -280)), this.lobbyAppearAction2));\r\n        }    \r\n        else\r\n        {\r\n            this.lbl_result_title.string = \"FAIL\";\r\n            this.cup_failed.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, -280)), this.lobbyAppearAction2));\r\n        }\r\n        this.lbl_result_title.node.runAction(cc.sequence(cc.moveBy(0.7, cc.v2(0, -280)), this.lobbyAppearAction1));        \r\n        this.lbl_score.node.runAction(cc.sequence(cc.moveBy(0.5, cc.v2(0, -280)), this.lobbyAppearAction3));\r\n        this.lbl_resul_moves.node.runAction(cc.sequence(cc.moveBy(0.4, cc.v2(0, -280)), this.lobbyAppearAction4));        \r\n\r\n        this.btn_restart.runAction(cc.sequence(cc.moveBy(0.2, cc.v2(320, 0)), this.lobbyAppearRestart));\r\n        this.btn_friend.runAction(cc.sequence(cc.moveBy(0.1, cc.v2(320, 0)), this.lobbyAppearFriend));\r\n        // this.game_successed = false;\r\n    },\r\n\r\n    callback_result_out: function()\r\n    {\r\n        this.result_pan.runAction(cc.sequence(\r\n            cc.moveBy(0.3, cc.v2(-320, 0)),\r\n            this.comeout_panAction, \r\n            cc.callFunc(this.restart_game.bind(this))\r\n        )); \r\n    },\r\n\r\n    restart_game: function()\r\n    {    \r\n        this.game_successed = false;\r\n        this.finished = false;  \r\n        this.clear_node();  \r\n        this.change_level(this.game_level);        \r\n        this.create_table();\r\n    },    \r\n\r\n    clear_node: function()\r\n    {\r\n        for (var row = 0; row < this.rows; row++) {            \r\n            for (var col = 0; col < this.rows; col++) {\r\n                this.node.removeChild(this.game_table[row][col].element);\r\n                this.game_table[row][col].element.destroy();\r\n                this.game_table[row][col].element = null;\r\n            }\r\n        }\r\n    },\r\n\r\n    reset_table: function()\r\n    {\r\n        this.numberToSpawn = this.rows * this.rows;        \r\n        this.start_table = {};        \r\n        for (var row = 0; row < this.rows; row++) {            \r\n            this.start_table[row] = {};            \r\n        }  \r\n\r\n        this.game_table = {};\r\n        for (var row = 0; row < this.rows; row++) {\r\n            this.game_table[row] = {};\r\n            for (var col = 0; col < this.rows; col++) {\r\n                this.game_table[row][col] = {\r\n                    colour: null,\r\n                    flooded: false,\r\n                    element: null\r\n                };\r\n            }\r\n        }\r\n    },\r\n\r\n    change_level: function (num)\r\n    {\r\n        this.game_successed = false;\r\n        this.game_level = num;\r\n        this.rows = this.level[num].rows;\r\n        this.limit_moves = this.level[num].limit;\r\n        this.level_name = this.level[num].name;\r\n        this.moves = 0;\r\n        this.updateMoves();\r\n        this.mode_label.string = this.level_name;        \r\n        this.reset_table();       \r\n    },\r\n\r\n    random_colour: function  ()\r\n    {        \r\n        var colour_no = Math.floor (Math.random () * 6);\r\n        return this.colours[colour_no];\r\n    },    \r\n\r\n    flood_element: function (row, col, colour)\r\n    {\r\n        this.game_table[row][col].colour = colour;\r\n        this.game_table[row][col].element.color = colour;\r\n    },\r\n\r\n    flood_neighbours: function  (row, col, colour)\r\n    {\r\n        if (row < this.rows - 1)\r\n        this.test_colour_flood (row + 1, col, colour);\r\n        if (row > 0)\r\n        this.test_colour_flood (row - 1, col, colour);\r\n        if (col < this.rows - 1)\r\n        this.test_colour_flood (row, col + 1, colour);\r\n        if (col > 0)\r\n        this.test_colour_flood (row, col - 1, colour);\r\n    },\r\n\r\n    test_colour_flood: function  (row, col, colour)\r\n    {\r\n        if (this.game_table[row][col].flooded)\r\n            return;\r\n        if (this.game_table[row][col].colour.equals(colour)) {\r\n            this.game_table[row][col].flooded = true;\r\n            this.flood_neighbours (row, col, colour);\r\n        }\r\n    },\r\n\r\n    all_flooded: function  ()\r\n    {\r\n        for (var row = 0; row < this.rows; row++) {\r\n            for (var col = 0; col < this.rows; col++) {\r\n                if (! this.game_table[row][col].flooded) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    flood: function(colour, initial)\r\n    {\r\n        if (this.finished)\r\n            return;\r\n        var old_colour = this.game_table[0][0].colour;\r\n        if (! initial && colour == old_colour)\r\n            return;\r\n        this.moves++;        \r\n        \r\n        for (var row = 0; row < this.rows; row++) \r\n            for (var col = 0; col < this.rows; col++) \r\n            {\r\n                if (this.game_table[row][col].flooded)\r\n                 {\r\n                    this.flood_element (row, col, colour);                    \r\n                 } \r\n            }      \r\n        for (var row = 0; row < this.rows; row++)\r\n            for (var col = 0; col < this.rows; col++)\r\n                if (this.game_table[row][col].flooded)\r\n                {\r\n                    this.flood_neighbours (row, col, colour);\r\n                }\r\n                \r\n        if (this.moves < this.limit_moves)\r\n        {\r\n            if (this.all_flooded ()) \r\n            {\r\n                this.finished = true;\r\n                this.game_successed = true;            \r\n                this.in_result_pan();\r\n            }\r\n        }\r\n        else\r\n            this.in_result_pan();       \r\n    },\r\n\r\n    create_table: function()\r\n    {\r\n        this.moves = -1;\r\n        this.finished = false;        \r\n        for (var row = 0; row < this.rows; row++) {            \r\n            for (var col = 0; col < this.rows; col++) \r\n            {        \r\n                var colour = this.random_colour();\r\n                this.game_table[row][col].colour = colour;\r\n                // this.start_table[row][col] = colour;\r\n                var star = this.spawnNewStarByNum(row, col, row, colour);                \r\n                this.game_table[row][col].element = star;\r\n                this.game_table[row][col].flooded = false;\r\n            }\r\n        }\r\n        this.game_table[0][0].flooded = true;\r\n        this.flood (this.game_table[0][0].colour, true);\r\n    },\r\n\r\n    setSpawnCordinate: function()\r\n    {         \r\n        for(var i = 0; i < this.rows; i++)\r\n            for(var j = 0; j <= i; j++)\r\n            {                 \r\n                this.spawnCount++;\r\n                this.start_table[i][j] = i -j + 1;\r\n            }\r\n        for(var i = 1; i < this.rows; i++)\r\n            for(var j = i; j < this.rows; j++)\r\n            {   \r\n                var inum = this.rows -j + i;     \r\n                this.spawnCount++; \r\n                this.start_table[i][j] = this.rows -j + i;\r\n            }\r\n    },\r\n\r\n    spawnNewStarByNum: function(i, j, inum, newcolour) {\r\n              \r\n        var newStar = cc.instantiate(this.floodPrefab);\r\n        var color = newStar.color;                \r\n        newStar.color = newcolour;\r\n        this.node.addChild(newStar);\r\n        \r\n        var starWidth = (this.canvas.width - 2 * this.marginX) / this.rows;\r\n        newStar.width = starWidth;\r\n        newStar.height = starWidth;      \r\n\r\n        var x =  starWidth * inum - this.canvas.width / 2 + starWidth / 2 + this.marginX;\r\n        var y =  this.canvas.height / 2 - starWidth * j - starWidth / 2  - this.marginy;\r\n        var pos = cc.v2( x , y);\r\n        newStar.setPosition(pos);   \r\n        return newStar;   \r\n    },\r\n\r\n    spawnNewStar: function() {\r\n\r\n        if (this.spawnCount >= this.numberToSpawn) {\r\n            return;\r\n        }\r\n       \r\n        var newStar = cc.instantiate(this.floodPrefab);\r\n        this.node.addChild(newStar);\r\n        newStar.zIndex = 3;\r\n        newStar.setPosition(this.getNewStarPosition(newStar.width));        \r\n        //newStar.setPosition(cc.v2(newStar.getPosition().x + newStar.node.width * i, 0)); \r\n        this.spawnCount++;\r\n    },\r\n\r\n    getNewStarPosition: function (starWidth) {\r\n        this.marginX = (this.canvas.width - starWidth * this.numberToSpawn / this.rows ) / 2;\r\n        // this.marginy = (this.canvas.height - starWidth * this.numberToSpawn / this.rows ) / 2;\r\n        var x =  starWidth * (this.spawnCount % this.rows) - this.canvas.width / 2 + starWidth / 2 + this.marginX;\r\n        var ynum = (this.spawnCount - (this.spawnCount % this.rows)) * this.rows;\r\n        var y =  this.canvas.height / 2 - starWidth * parseInt(this.spawnCount / this.rows) - starWidth / 2  - this.marginy;\r\n        return cc.v2( x , y);\r\n    },\r\n\r\n    new_game: function()\r\n    {\r\n        this.create_table();\r\n    },\r\n\r\n    updateMoves: function () {                \r\n        this.move_display.string = this.moves + \" / \" + this.limit_moves; \r\n    },\r\n\r\n    gainScore: function () {\r\n        // this.score += 1;        \r\n        // this.scoreDisplay.string = this.score;        \r\n        // cc.audioEngine.playEffect(this.scoreAudio, false);\r\n    },\r\n\r\n    gameOver: function () {\r\n        // this.player.stopAllActions(); \r\n        cc.director.loadScene('game');\r\n    }\r\n});\r\n"]}