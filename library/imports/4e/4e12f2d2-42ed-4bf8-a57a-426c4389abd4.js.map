{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.js"],"names":["cc","Class","extends","Component","properties","level","floodPrefab","default","type","Prefab","canvas","Node","move_display","Label","scoreAudio","AudioClip","mode_label","setting_pan","result_pan","btn_restart","btn_friend","lbl_result_title","cup_success","cup_failed","lbl_score","lbl_resul_moves","btn_pause","Sprite","spawnInterval","onLoad","spawnCount","name","rows","limit","actions","events","initialize","create_table","schedule","spawnNewStar","score","finished","game_level","game_successed","colours","Color","BLUE","RED","GREEN","YELLOW","ORANGE","MAGENTA","marginX","marginy","change_level","comein_panAction","moveBy","v2","easing","easeCubicActionOut","comeout_panAction","goout_pan","lobbyAppearAction1","easeElasticOut","lobbyAppearAction2","lobbyAppearAction3","lobbyAppearAction4","lobbyAppearRestart","lobbyAppearFriend","lobbyDisAppearAction1","lobbyDisAppearAction2","lobbyDisAppearAction3","lobbyDisAppearAction4","lobbyDisAppearRestart","lobbyDisAppearFriend","on","EventType","MOUSE_DOWN","out_result_pan_restart","in_result_pan","b_result","zIndex","node","runAction","sequence","fadeOut","delayTime","callFunc","callback_result_in","bind","fadeIn","callback_result_out","string","restart_game","clear_node","row","col","removeChild","game_table","element","destroy","reset_table","numberToSpawn","start_table","colour","flooded","num","limit_moves","level_name","moves","updateMoves","setSpawnCordinate","random_colour","colour_no","Math","floor","random","flood_element","color","flood_neighbours","test_colour_flood","equals","all_flooded","flood","initial","old_colour","star","spawnNewStarByNum","i","j","inum","newcolour","newStar","instantiate","starWidth","width","height","x","y","pos","setPosition","getNewStarPosition","parseInt","addChild","new_game","gainScore","gameOver","director","loadScene"],"mappings":";;;;;;AAAAA,GAAGC,KAAH,CAAS;AACLC,aAASF,GAAGG,SADP;;AAGLC,gBAAY;AACRC,eAAM,EADE;AAERC,qBAAa;AACTC,qBAAS,IADA;AAETC,kBAAMR,GAAGS;AAFA,SAFL;AAMRC,gBAAQ;AACJH,qBAAS,IADL;AAEJC,kBAAMR,GAAGW;AAFL,SANA;AAURC,sBAAc;AACVL,qBAAS,IADC;AAEVC,kBAAMR,GAAGa;AAFC,SAVN;AAcRC,oBAAY;AACRP,qBAAS,IADD;AAERC,kBAAMR,GAAGe;AAFD,SAdJ;AAkBRC,oBAAY;AACRT,qBAAS,IADD;AAERC,kBAAMR,GAAGa;AAFD,SAlBJ;AAsBRI,qBAAa;AACTV,qBAAS,IADA;AAETC,kBAAMR,GAAGW;AAFA,SAtBL;AA0BRO,oBAAY;AACRX,qBAAS,IADD;AAERC,kBAAMR,GAAGW;AAFD,SA1BJ;AA8BRQ,qBAAa;AACTZ,qBAAS,IADA;AAETC,kBAAMR,GAAGW;AAFA,SA9BL;AAkCRS,oBAAY;AACRb,qBAAS,IADD;AAERC,kBAAMR,GAAGW;AAFD,SAlCJ;AAsCRU,0BAAkB;AACdd,qBAAS,IADK;AAEdC,kBAAMR,GAAGa;AAFK,SAtCV;AA0CRS,qBAAa;AACTf,qBAAS,IADA;AAETC,kBAAMR,GAAGW;AAFA,SA1CL;AA8CRY,oBAAY;AACRhB,qBAAS,IADD;AAERC,kBAAMR,GAAGW;AAFD,SA9CJ;AAkDRa,mBAAW;AACPjB,qBAAS,IADF;AAEPC,kBAAMR,GAAGa;AAFF,SAlDH;AAsDRY,yBAAiB;AACblB,qBAAS,IADI;AAEbC,kBAAMR,GAAGa;AAFI,SAtDT;AA0DRa,mBAAW;AACPnB,qBAAS,IADF;AAEPC,kBAAMR,GAAG2B;AAFF,SA1DH;AA8DRC,uBAAe;AA9DP,KAHP;;AAoELC,YAAQ,kBAAY;;AAEhB,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKzB,KAAL,GACA,CACI,EAAI0B,MAAM,QAAV,EAAqBC,MAAK,EAA1B,EAA8BC,OAAO,EAArC,EADJ,EAEI,EAAIF,MAAM,MAAV,EAAqBC,MAAK,EAA1B,EAA8BC,OAAO,EAArC,EAFJ,EAGI,EAAIF,MAAM,MAAV,EAAqBC,MAAK,EAA1B,EAA8BC,OAAO,EAArC,EAHJ,EAII,EAAIF,MAAM,SAAV,EAAqBC,MAAK,EAA1B,EAA8BC,OAAO,EAArC,EAJJ,CADA;;AAQA,aAAKC,OAAL;AACA,aAAKC,MAAL;;AAEA,aAAKC,UAAL;AACA,aAAKC,YAAL;AACA,aAAKC,QAAL,CAAc,KAAKC,YAAnB,EAAiC,KAAKX,aAAtC;AACA,aAAKY,KAAL,GAAa,CAAb;AACH,KAtFI;;AAwFLJ,gBAAY,sBACZ;AACI,aAAKK,QAAL,GAAgB,KAAhB;AACA,aAAKC,UAAL,GAAkB,CAAlB;AACA,aAAKC,cAAL,GAAsB,KAAtB;AACA,aAAKC,OAAL,GAAe,CAAC5C,GAAG6C,KAAH,CAASC,IAAV,EAAgB9C,GAAG6C,KAAH,CAASE,GAAzB,EAA6B/C,GAAG6C,KAAH,CAASG,KAAtC,EAA4ChD,GAAG6C,KAAH,CAASI,MAArD,EAA4DjD,GAAG6C,KAAH,CAASK,MAArE,EAA4ElD,GAAG6C,KAAH,CAASM,OAArF,CAAf;AACA,aAAKC,OAAL,GAAe,EAAf;AACA,aAAKC,OAAL,GAAe,GAAf;;AAEA,aAAKC,YAAL,CAAkB,KAAKZ,UAAvB;AACH,KAlGI;;AAoGLR,aAAS,mBACT;AACI,aAAKqB,gBAAL,GAAwBvD,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,GAAN,EAAW,CAAX,CAAf,EAA8BC,MAA9B,CAAqC1D,GAAG2D,kBAAH,EAArC,CAAxB;AACA,aAAKC,iBAAL,GAAyB5D,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAC,GAAP,EAAY,CAAZ,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG2D,kBAAH,EAAtC,CAAzB;AACA,aAAKE,SAAL,GAAiB7D,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAC,GAAP,EAAY,CAAZ,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG2D,kBAAH,EAAtC,CAAjB;;AAEA;AACA,aAAKG,kBAAL,GAA0B9D,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG+D,cAAH,EAAtC,CAA1B;AACA,aAAKC,kBAAL,GAA0BhE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG+D,cAAH,EAAtC,CAA1B;AACA,aAAKE,kBAAL,GAA0BjE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG+D,cAAH,EAAtC,CAA1B;AACA,aAAKG,kBAAL,GAA0BlE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG+D,cAAH,EAAtC,CAA1B;;AAEA,aAAKI,kBAAL,GAA0BnE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,GAAN,EAAW,CAAX,CAAf,EAA8BC,MAA9B,CAAqC1D,GAAG+D,cAAH,EAArC,CAA1B;AACA,aAAKK,iBAAL,GAAyBpE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,GAAN,EAAW,CAAX,CAAf,EAA8BC,MAA9B,CAAqC1D,GAAG+D,cAAH,EAArC,CAAzB;;AAEA;AACA,aAAKM,qBAAL,GAA6BrE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,EAA8BC,MAA9B,CAAqC1D,GAAG+D,cAAH,EAArC,CAA7B;AACA,aAAKO,qBAAL,GAA6BtE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,EAA8BC,MAA9B,CAAqC1D,GAAG+D,cAAH,EAArC,CAA7B;AACA,aAAKQ,qBAAL,GAA6BvE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,EAA8BC,MAA9B,CAAqC1D,GAAG+D,cAAH,EAArC,CAA7B;AACA,aAAKS,qBAAL,GAA6BxE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,EAA8BC,MAA9B,CAAqC1D,GAAG+D,cAAH,EAArC,CAA7B;;AAEA,aAAKU,qBAAL,GAA6BzE,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAC,GAAP,EAAY,CAAZ,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG+D,cAAH,EAAtC,CAA7B;AACA,aAAKW,oBAAL,GAA4B1E,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAC,GAAP,EAAY,CAAZ,CAAf,EAA+BC,MAA/B,CAAsC1D,GAAG+D,cAAH,EAAtC,CAA5B;AACH,KA3HI;;AA6HL5B,YAAQ,kBACR;AACI,aAAKhB,WAAL,CAAiBwD,EAAjB,CAAoB3E,GAAGW,IAAH,CAAQiE,SAAR,CAAkBC,UAAtC,EAAkD,YAAY;AAC1D,iBAAKC,sBAAL;AACH,SAFD,EAEG,IAFH;;AAIA,aAAK1D,UAAL,CAAgBuD,EAAhB,CAAmB3E,GAAGW,IAAH,CAAQiE,SAAR,CAAkBC,UAArC,EAAiD,YAAY;AACzD;AACH,SAFD,EAEG,IAFH;AAGH,KAtII;;AAwILE,mBAAe,uBAASC,QAAT,EACf;AACI,aAAK/D,WAAL,CAAiBgE,MAAjB,GAA0B,CAA1B;AACA,aAAKvD,SAAL,CAAewD,IAAf,CAAoBC,SAApB,CAA8BnF,GAAGoF,QAAH,CAC1BpF,GAAGqF,OAAH,CAAW,GAAX,CAD0B,EAE1BrF,GAAGsF,SAAH,CAAa,GAAb,CAF0B,CAA9B;AAIA,aAAKpE,UAAL,CAAgBiE,SAAhB,CAA0BnF,GAAGoF,QAAH,CACtBpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,GAAN,EAAW,CAAX,CAAf,CADsB,EAEtB,KAAKF,gBAFiB,EAGtBvD,GAAGuF,QAAH,CAAY,KAAKC,kBAAL,CAAwBC,IAAxB,CAA6B,IAA7B,CAAZ,CAHsB,CAA1B;AAKH,KApJI;;AAsJLX,4BAAwB,kCACxB;AACI,aAAKpD,SAAL,CAAewD,IAAf,CAAoBC,SAApB,CAA8BnF,GAAGoF,QAAH,CAC1BpF,GAAG0F,MAAH,CAAU,GAAV,CAD0B,EAE1B1F,GAAGsF,SAAH,CAAa,GAAb,CAF0B,CAA9B;AAIA,YAAG,KAAK3C,cAAR,EACA;AACI,iBAAKrB,WAAL,CAAiB6D,SAAjB,CAA2BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,CAAZ,EAA2C,KAAKa,qBAAhD,CAA3B;AACH,SAHD,MAKA;AACI,iBAAK/C,UAAL,CAAgB4D,SAAhB,CAA0BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,CAAZ,EAA2C,KAAKa,qBAAhD,CAA1B;AACH;AACD,aAAKjD,gBAAL,CAAsB6D,IAAtB,CAA2BC,SAA3B,CAAqCnF,GAAGoF,QAAH,CACjCpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,CADiC,EAEjC,KAAKY,qBAF4B,EAGjCrE,GAAGuF,QAAH,CAAY,KAAKI,mBAAL,CAAyBF,IAAzB,CAA8B,IAA9B,CAAZ,CAHiC,CAArC;AAKA,aAAKjE,SAAL,CAAe0D,IAAf,CAAoBC,SAApB,CAA8BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,CAAZ,EAA2C,KAAKc,qBAAhD,CAA9B;AACA,aAAK9C,eAAL,CAAqByD,IAArB,CAA0BC,SAA1B,CAAoCnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,GAAT,CAAf,CAAZ,EAA2C,KAAKe,qBAAhD,CAApC;;AAEA,aAAKrD,WAAL,CAAiBgE,SAAjB,CAA2BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAC,GAAP,EAAY,CAAZ,CAAf,CAAZ,EAA4C,KAAKgB,qBAAjD,CAA3B;AACA,aAAKrD,UAAL,CAAgB+D,SAAhB,CAA0BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAC,GAAP,EAAY,CAAZ,CAAf,CAAZ,EAA4C,KAAKiB,oBAAjD,CAA1B;AAEH,KA/KI;;AAiLLc,wBAAoB,8BACpB;AACI,YAAG,KAAK7C,cAAR,EACA;AACI,iBAAKtB,gBAAL,CAAsBuE,MAAtB,GAA+B,MAA/B;AACA,iBAAKtE,WAAL,CAAiB6D,SAAjB,CAA2BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,CAAZ,EAA4C,KAAKO,kBAAjD,CAA3B;AACH,SAJD,MAMA;AACI,iBAAK3C,gBAAL,CAAsBuE,MAAtB,GAA+B,MAA/B;AACA,iBAAKrE,UAAL,CAAgB4D,SAAhB,CAA0BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,CAAZ,EAA4C,KAAKO,kBAAjD,CAA1B;AACH;AACD,aAAK3C,gBAAL,CAAsB6D,IAAtB,CAA2BC,SAA3B,CAAqCnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,CAAZ,EAA4C,KAAKK,kBAAjD,CAArC;AACA,aAAKtC,SAAL,CAAe0D,IAAf,CAAoBC,SAApB,CAA8BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,CAAZ,EAA4C,KAAKQ,kBAAjD,CAA9B;AACA,aAAKxC,eAAL,CAAqByD,IAArB,CAA0BC,SAA1B,CAAoCnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAN,EAAS,CAAC,GAAV,CAAf,CAAZ,EAA4C,KAAKS,kBAAjD,CAApC;;AAEA,aAAK/C,WAAL,CAAiBgE,SAAjB,CAA2BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,GAAN,EAAW,CAAX,CAAf,CAAZ,EAA2C,KAAKU,kBAAhD,CAA3B;AACA,aAAK/C,UAAL,CAAgB+D,SAAhB,CAA0BnF,GAAGoF,QAAH,CAAYpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,GAAN,EAAW,CAAX,CAAf,CAAZ,EAA2C,KAAKW,iBAAhD,CAA1B;AACA;AACH,KApMI;;AAsMLuB,yBAAqB,+BACrB;AACI,aAAKzE,UAAL,CAAgBiE,SAAhB,CAA0BnF,GAAGoF,QAAH,CACtBpF,GAAGwD,MAAH,CAAU,GAAV,EAAexD,GAAGyD,EAAH,CAAM,CAAC,GAAP,EAAY,CAAZ,CAAf,CADsB,EAEtB,KAAKG,iBAFiB,EAGtB5D,GAAGuF,QAAH,CAAY,KAAKM,YAAL,CAAkBJ,IAAlB,CAAuB,IAAvB,CAAZ,CAHsB,CAA1B;AAKH,KA7MI;;AA+MLI,kBAAc,wBACd;AACI,aAAKlD,cAAL,GAAsB,KAAtB;AACA,aAAKF,QAAL,GAAgB,KAAhB;AACA,aAAKqD,UAAL;AACA,aAAKxC,YAAL,CAAkB,KAAKZ,UAAvB;AACA,aAAKL,YAAL;AACH,KAtNI;;AAwNLyD,gBAAY,sBACZ;AACI,aAAK,IAAIC,MAAM,CAAf,EAAkBA,MAAM,KAAK/D,IAA7B,EAAmC+D,KAAnC,EAA0C;AACtC,iBAAK,IAAIC,MAAM,CAAf,EAAkBA,MAAM,KAAKhE,IAA7B,EAAmCgE,KAAnC,EAA0C;AACtC,qBAAKd,IAAL,CAAUe,WAAV,CAAsB,KAAKC,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BG,OAAhD;AACA,qBAAKD,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BG,OAA1B,CAAkCC,OAAlC;AACA,qBAAKF,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BG,OAA1B,GAAoC,IAApC;AACH;AACJ;AACJ,KAjOI;;AAmOLE,iBAAa,uBACb;AACI,aAAKC,aAAL,GAAqB,KAAKtE,IAAL,GAAY,KAAKA,IAAtC;AACA,aAAKuE,WAAL,GAAmB,EAAnB;AACA,aAAK,IAAIR,MAAM,CAAf,EAAkBA,MAAM,KAAK/D,IAA7B,EAAmC+D,KAAnC,EAA0C;AACtC,iBAAKQ,WAAL,CAAiBR,GAAjB,IAAwB,EAAxB;AACH;;AAED,aAAKG,UAAL,GAAkB,EAAlB;AACA,aAAK,IAAIH,MAAM,CAAf,EAAkBA,MAAM,KAAK/D,IAA7B,EAAmC+D,KAAnC,EAA0C;AACtC,iBAAKG,UAAL,CAAgBH,GAAhB,IAAuB,EAAvB;AACA,iBAAK,IAAIC,MAAM,CAAf,EAAkBA,MAAM,KAAKhE,IAA7B,EAAmCgE,KAAnC,EAA0C;AACtC,qBAAKE,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,IAA4B;AACxBQ,4BAAQ,IADgB;AAExBC,6BAAS,KAFe;AAGxBN,6BAAS;AAHe,iBAA5B;AAKH;AACJ;AACJ,KAtPI;;AAwPL7C,kBAAc,sBAAUoD,GAAV,EACd;AACI,aAAK/D,cAAL,GAAsB,KAAtB;AACA,aAAKD,UAAL,GAAkBgE,GAAlB;AACA,aAAK1E,IAAL,GAAY,KAAK3B,KAAL,CAAWqG,GAAX,EAAgB1E,IAA5B;AACA,aAAK2E,WAAL,GAAmB,KAAKtG,KAAL,CAAWqG,GAAX,EAAgBzE,KAAnC;AACA,aAAK2E,UAAL,GAAkB,KAAKvG,KAAL,CAAWqG,GAAX,EAAgB3E,IAAlC;AACA,aAAK8E,KAAL,GAAa,CAAb;AACA,aAAKC,WAAL;AACA,aAAK9F,UAAL,CAAgB4E,MAAhB,GAAyB,KAAKgB,UAA9B;AACA,aAAKP,WAAL;AACA,aAAKU,iBAAL;AACH,KApQI;;AAsQLC,mBAAe,yBACf;AACI,YAAIC,YAAYC,KAAKC,KAAL,CAAYD,KAAKE,MAAL,KAAiB,CAA7B,CAAhB;AACA,eAAO,KAAKxE,OAAL,CAAaqE,SAAb,CAAP;AACH,KA1QI;;AA4QLI,mBAAe,uBAAUtB,GAAV,EAAeC,GAAf,EAAoBQ,MAApB,EACf;AACI,aAAKN,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BQ,MAA1B,GAAmCA,MAAnC;AACA,aAAKN,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BG,OAA1B,CAAkCmB,KAAlC,GAA0Cd,MAA1C;AACH,KAhRI;;AAkRLe,sBAAkB,0BAAWxB,GAAX,EAAgBC,GAAhB,EAAqBQ,MAArB,EAClB;AACI,YAAIT,MAAM,KAAK/D,IAAL,GAAY,CAAtB,EACA,KAAKwF,iBAAL,CAAwBzB,MAAM,CAA9B,EAAiCC,GAAjC,EAAsCQ,MAAtC;AACA,YAAIT,MAAM,CAAV,EACA,KAAKyB,iBAAL,CAAwBzB,MAAM,CAA9B,EAAiCC,GAAjC,EAAsCQ,MAAtC;AACA,YAAIR,MAAM,KAAKhE,IAAL,GAAY,CAAtB,EACA,KAAKwF,iBAAL,CAAwBzB,GAAxB,EAA6BC,MAAM,CAAnC,EAAsCQ,MAAtC;AACA,YAAIR,MAAM,CAAV,EACA,KAAKwB,iBAAL,CAAwBzB,GAAxB,EAA6BC,MAAM,CAAnC,EAAsCQ,MAAtC;AACH,KA5RI;;AA8RLgB,uBAAmB,2BAAWzB,GAAX,EAAgBC,GAAhB,EAAqBQ,MAArB,EACnB;AACI,YAAI,KAAKN,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BS,OAA9B,EACI;AACJ,YAAI,KAAKP,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BQ,MAA1B,CAAiCiB,MAAjC,CAAwCjB,MAAxC,CAAJ,EAAqD;AACjD,iBAAKN,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BS,OAA1B,GAAoC,IAApC;AACA,iBAAKc,gBAAL,CAAuBxB,GAAvB,EAA4BC,GAA5B,EAAiCQ,MAAjC;AACH;AACJ,KAtSI;;AAwSLkB,iBAAa,uBACb;AACI,aAAK,IAAI3B,MAAM,CAAf,EAAkBA,MAAM,KAAK/D,IAA7B,EAAmC+D,KAAnC,EAA0C;AACtC,iBAAK,IAAIC,MAAM,CAAf,EAAkBA,MAAM,KAAKhE,IAA7B,EAAmCgE,KAAnC,EAA0C;AACtC,oBAAI,CAAE,KAAKE,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BS,OAAhC,EAAyC;AACrC,2BAAO,KAAP;AACH;AACJ;AACJ;AACD,eAAO,IAAP;AACH,KAlTI;;AAoTLkB,WAAO,eAASnB,MAAT,EAAiBoB,OAAjB,EACP;AACI,YAAI,KAAKnF,QAAT,EACI;AACJ,YAAIoF,aAAa,KAAK3B,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsBM,MAAvC;AACA,YAAI,CAAEoB,OAAF,IAAapB,UAAUqB,UAA3B,EACI;AACJ,aAAKhB,KAAL;;AAEA,aAAK,IAAId,MAAM,CAAf,EAAkBA,MAAM,KAAK/D,IAA7B,EAAmC+D,KAAnC;AACI,iBAAK,IAAIC,MAAM,CAAf,EAAkBA,MAAM,KAAKhE,IAA7B,EAAmCgE,KAAnC,EACA;AACI,oBAAI,KAAKE,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BS,OAA9B,EACC;AACG,yBAAKY,aAAL,CAAoBtB,GAApB,EAAyBC,GAAzB,EAA8BQ,MAA9B;AACF;AACL;AAPL,SAQA,KAAK,IAAIT,MAAM,CAAf,EAAkBA,MAAM,KAAK/D,IAA7B,EAAmC+D,KAAnC;AACI,iBAAK,IAAIC,MAAM,CAAf,EAAkBA,MAAM,KAAKhE,IAA7B,EAAmCgE,KAAnC;AACI,oBAAI,KAAKE,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BS,OAA9B,EACA;AACI,yBAAKc,gBAAL,CAAuBxB,GAAvB,EAA4BC,GAA5B,EAAiCQ,MAAjC;AACH;AAJL;AADJ,SAOA,IAAI,KAAKK,KAAL,GAAa,KAAKF,WAAtB,EACA;AACI,gBAAI,KAAKe,WAAL,EAAJ,EACA;AACI,qBAAKjF,QAAL,GAAgB,IAAhB;AACA,qBAAKE,cAAL,GAAsB,IAAtB;AACA,qBAAKoC,aAAL;AACH;AACJ,SARD,MAUI,KAAKA,aAAL;AACP,KAvVI;;AAyVL1C,kBAAc,wBACd;AACI,aAAKwE,KAAL,GAAa,CAAC,CAAd;AACA,aAAKpE,QAAL,GAAgB,KAAhB;AACA,aAAK,IAAIsD,MAAM,CAAf,EAAkBA,MAAM,KAAK/D,IAA7B,EAAmC+D,KAAnC,EAA0C;AACtC,iBAAK,IAAIC,MAAM,CAAf,EAAkBA,MAAM,KAAKhE,IAA7B,EAAmCgE,KAAnC,EACA;AACI,oBAAIQ,SAAS,KAAKQ,aAAL,EAAb;AACA,qBAAKd,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BQ,MAA1B,GAAmCA,MAAnC;AACA;AACA,oBAAIsB,OAAO,KAAKC,iBAAL,CAAuBhC,GAAvB,EAA4BC,GAA5B,EAAiCD,GAAjC,EAAsCS,MAAtC,CAAX;AACA,qBAAKN,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BG,OAA1B,GAAoC2B,IAApC;AACA,qBAAK5B,UAAL,CAAgBH,GAAhB,EAAqBC,GAArB,EAA0BS,OAA1B,GAAoC,KAApC;AACH;AACJ;AACD,aAAKP,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsBO,OAAtB,GAAgC,IAAhC;AACA,aAAKkB,KAAL,CAAY,KAAKzB,UAAL,CAAgB,CAAhB,EAAmB,CAAnB,EAAsBM,MAAlC,EAA0C,IAA1C;AACH,KA1WI;;AA4WLO,uBAAmB,6BACnB;AACI,aAAI,IAAIiB,IAAI,CAAZ,EAAeA,IAAI,KAAKhG,IAAxB,EAA8BgG,GAA9B;AACI,iBAAI,IAAIC,IAAI,CAAZ,EAAeA,KAAKD,CAApB,EAAuBC,GAAvB,EACA;AACI,qBAAKnG,UAAL;AACA,qBAAKyE,WAAL,CAAiByB,CAAjB,EAAoBC,CAApB,IAAyBD,IAAGC,CAAH,GAAO,CAAhC;AACH;AALL,SAMA,KAAI,IAAID,IAAI,CAAZ,EAAeA,IAAI,KAAKhG,IAAxB,EAA8BgG,GAA9B;AACI,iBAAI,IAAIC,IAAID,CAAZ,EAAeC,IAAI,KAAKjG,IAAxB,EAA8BiG,GAA9B,EACA;AACI,oBAAIC,OAAO,KAAKlG,IAAL,GAAWiG,CAAX,GAAeD,CAA1B;AACA,qBAAKlG,UAAL;AACA,qBAAKyE,WAAL,CAAiByB,CAAjB,EAAoBC,CAApB,IAAyB,KAAKjG,IAAL,GAAWiG,CAAX,GAAeD,CAAxC;AACH;AANL,SAQI,KAAKlG,UAAL,GAAkB,CAAlB;AACP,KA7XI;;AA+XLiG,uBAAmB,2BAASC,CAAT,EAAYC,CAAZ,EAAeC,IAAf,EAAqBC,SAArB,EAAgC;;AAE/C,YAAIC,UAAUpI,GAAGqI,WAAH,CAAe,KAAK/H,WAApB,CAAd;AACA,YAAIgH,QAAQc,QAAQd,KAApB;AACAc,gBAAQd,KAAR,GAAgBa,SAAhB;AACA;;AAEA,YAAIG,YAAY,CAAC,KAAK5H,MAAL,CAAY6H,KAAZ,GAAoB,IAAI,KAAKnF,OAA9B,IAAyC,KAAKpB,IAA9D;AACAoG,gBAAQG,KAAR,GAAgBD,SAAhB;AACAF,gBAAQI,MAAR,GAAiBF,SAAjB;;AAEA,YAAIG,IAAKH,YAAYJ,IAAZ,GAAmB,KAAKxH,MAAL,CAAY6H,KAAZ,GAAoB,CAAvC,GAA2CD,YAAY,CAAvD,GAA2D,KAAKlF,OAAzE;AACA,YAAIsF,IAAK,KAAKhI,MAAL,CAAY8H,MAAZ,GAAqB,CAArB,GAAyBF,YAAYL,CAArC,GAAyCK,YAAY,CAArD,GAA0D,KAAKjF,OAAxE;AACA,YAAIsF,MAAM3I,GAAGyD,EAAH,CAAOgF,CAAP,EAAWC,CAAX,CAAV;AACAN,gBAAQQ,WAAR,CAAoBD,GAApB;AACA,eAAOP,OAAP;AACH,KA/YI;;AAiZL7F,kBAAc,wBACd;AACI,YAAI,KAAKT,UAAL,IAAmB,KAAKwE,aAA5B,EAA2C;AACvC;AACH;;AAED;AACA;AACA;AACA;AACA;;AAEA,aAAKuC,kBAAL;AACA,aAAK/G,UAAL;AACH,KA/ZI;;AAiaL+G,wBAAoB,4BAAUP,SAAV,EAAqB;;AAErC,YAAIN,IAAI,KAAKlG,UAAL,GAAkB,KAAKE,IAA/B;AACA,YAAIiG,IAAIa,SAAS,KAAKhH,UAAL,GAAkB,KAAKE,IAAhC,CAAR;AACA,YAAIoG,UAAU,KAAKlC,UAAL,CAAgB8B,CAAhB,EAAmBC,CAAnB,EAAsB9B,OAApC;AACA;AACAiC,gBAAQnD,MAAR,GAAiB,CAAjB;AACA,aAAKC,IAAL,CAAU6D,QAAV,CAAmBX,OAAnB;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACH,KApbI;;AAsbLY,cAAU,oBACV;AACI,aAAK3G,YAAL;AACH,KAzbI;;AA2bLyE,iBAAa,uBAAY;AACrB,aAAKlG,YAAL,CAAkBgF,MAAlB,GAA2B,KAAKiB,KAAL,GAAa,KAAb,GAAqB,KAAKF,WAArD;AACH,KA7bI;;AA+bLsC,eAAW,qBAAY;AACnB;AACA;AACA;AACH,KAncI;;AAqcLC,cAAU,oBAAY;AAClB;AACAlJ,WAAGmJ,QAAH,CAAYC,SAAZ,CAAsB,MAAtB;AACH;AAxcI,CAAT","file":"Game.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        level:[],\r\n        floodPrefab: {\r\n            default: null,\r\n            type: cc.Prefab\r\n        },\r\n        canvas: {\r\n            default: null,\r\n            type: cc.Node\r\n        },              \r\n        move_display: {\r\n            default: null,\r\n            type: cc.Label\r\n        },       \r\n        scoreAudio: {\r\n            default: null,\r\n            type: cc.AudioClip\r\n        },\r\n        mode_label: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        setting_pan: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        result_pan: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        btn_restart: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        btn_friend: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        lbl_result_title: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        cup_success: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        cup_failed: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n        lbl_score: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        lbl_resul_moves: {\r\n            default: null,\r\n            type: cc.Label\r\n        },\r\n        btn_pause: {\r\n            default: null,\r\n            type: cc.Sprite\r\n        },\r\n        spawnInterval: 0,        \r\n    },\r\n\r\n    onLoad: function () { \r\n        \r\n        this.spawnCount = 0;       \r\n        this.level = \r\n        [\r\n            {   name: \"Normal\",  rows:10, limit: 18 },\r\n            {   name: \"Hard\",    rows:12, limit: 24 },\r\n            {   name: \"Hell\",    rows:18, limit: 31 },\r\n            {   name: \"Extreme\", rows:24, limit: 41 }\r\n        ];\r\n        \r\n        this.actions();\r\n        this.events();        \r\n \r\n        this.initialize();        \r\n        this.create_table();        \r\n        this.schedule(this.spawnNewStar, this.spawnInterval);\r\n        this.score = 0;\r\n    },\r\n\r\n    initialize: function()\r\n    {\r\n        this.finished = false;\r\n        this.game_level = 0;\r\n        this.game_successed = false;\r\n        this.colours = [cc.Color.BLUE, cc.Color.RED,cc.Color.GREEN,cc.Color.YELLOW,cc.Color.ORANGE,cc.Color.MAGENTA];        \r\n        this.marginX = 50;\r\n        this.marginy = 180;\r\n\r\n        this.change_level(this.game_level);\r\n    },\r\n\r\n    actions: function()\r\n    {\r\n        this.comein_panAction = cc.moveBy(0.5, cc.v2(320, 0)).easing(cc.easeCubicActionOut());\r\n        this.comeout_panAction = cc.moveBy(0.5, cc.v2(-320, 0)).easing(cc.easeCubicActionOut());\r\n        this.goout_pan = cc.moveBy(0.5, cc.v2(-640, 0)).easing(cc.easeCubicActionOut());\r\n\r\n        //Appear Result Pan\r\n        this.lobbyAppearAction1 = cc.moveBy(0.7, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearAction2 = cc.moveBy(0.6, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearAction3 = cc.moveBy(0.5, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearAction4 = cc.moveBy(0.4, cc.v2(0, -280)).easing(cc.easeElasticOut());\r\n\r\n        this.lobbyAppearRestart = cc.moveBy(0.2, cc.v2(320, 0)).easing(cc.easeElasticOut());\r\n        this.lobbyAppearFriend = cc.moveBy(0.1, cc.v2(320, 0)).easing(cc.easeElasticOut());  \r\n        \r\n        //Disapper Result Pan\r\n        this.lobbyDisAppearAction1 = cc.moveBy(0.7, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearAction2 = cc.moveBy(0.6, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearAction3 = cc.moveBy(0.5, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearAction4 = cc.moveBy(0.4, cc.v2(0, 280)).easing(cc.easeElasticOut());\r\n\r\n        this.lobbyDisAppearRestart = cc.moveBy(0.2, cc.v2(-320, 0)).easing(cc.easeElasticOut());\r\n        this.lobbyDisAppearFriend = cc.moveBy(0.1, cc.v2(-320, 0)).easing(cc.easeElasticOut());\r\n    },\r\n\r\n    events: function()\r\n    {\r\n        this.btn_restart.on(cc.Node.EventType.MOUSE_DOWN, function () {            \r\n            this.out_result_pan_restart();                   \r\n        }, this);\r\n\r\n        this.btn_friend.on(cc.Node.EventType.MOUSE_DOWN, function () {            \r\n            // web service                   \r\n        }, this);\r\n    },\r\n\r\n    in_result_pan: function(b_result)\r\n    {\r\n        this.setting_pan.zIndex = 3;\r\n        this.btn_pause.node.runAction(cc.sequence(\r\n            cc.fadeOut(0.7),\r\n            cc.delayTime(0.1)\r\n        ));\r\n        this.result_pan.runAction(cc.sequence(\r\n            cc.moveBy(0.3, cc.v2(320, 0)),\r\n            this.comein_panAction, \r\n            cc.callFunc(this.callback_result_in.bind(this))\r\n        )); \r\n    },\r\n\r\n    out_result_pan_restart: function()\r\n    { \r\n        this.btn_pause.node.runAction(cc.sequence(\r\n            cc.fadeIn(1.5),\r\n            cc.delayTime(0.1)\r\n        ));\r\n        if(this.game_successed)           \r\n        {\r\n            this.cup_success.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, 280)), this.lobbyDisAppearAction2));\r\n        }    \r\n        else\r\n        {\r\n            this.cup_failed.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, 280)), this.lobbyDisAppearAction2));\r\n        }\r\n        this.lbl_result_title.node.runAction(cc.sequence(\r\n            cc.moveBy(0.7, cc.v2(0, 280)),\r\n            this.lobbyDisAppearAction1,\r\n            cc.callFunc(this.callback_result_out.bind(this))\r\n        ));\r\n        this.lbl_score.node.runAction(cc.sequence(cc.moveBy(0.5, cc.v2(0, 280)), this.lobbyDisAppearAction3));\r\n        this.lbl_resul_moves.node.runAction(cc.sequence(cc.moveBy(0.4, cc.v2(0, 280)), this.lobbyDisAppearAction4));        \r\n\r\n        this.btn_restart.runAction(cc.sequence(cc.moveBy(0.2, cc.v2(-320, 0)), this.lobbyDisAppearRestart));\r\n        this.btn_friend.runAction(cc.sequence(cc.moveBy(0.1, cc.v2(-320, 0)), this.lobbyDisAppearFriend));\r\n\r\n    },\r\n\r\n    callback_result_in: function()\r\n    {\r\n        if(this.game_successed)           \r\n        {\r\n            this.lbl_result_title.string = \"PASS\";\r\n            this.cup_success.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, -280)), this.lobbyAppearAction2));\r\n        }    \r\n        else\r\n        {\r\n            this.lbl_result_title.string = \"FAIL\";\r\n            this.cup_failed.runAction(cc.sequence(cc.moveBy(0.6, cc.v2(0, -280)), this.lobbyAppearAction2));\r\n        }\r\n        this.lbl_result_title.node.runAction(cc.sequence(cc.moveBy(0.7, cc.v2(0, -280)), this.lobbyAppearAction1));        \r\n        this.lbl_score.node.runAction(cc.sequence(cc.moveBy(0.5, cc.v2(0, -280)), this.lobbyAppearAction3));\r\n        this.lbl_resul_moves.node.runAction(cc.sequence(cc.moveBy(0.4, cc.v2(0, -280)), this.lobbyAppearAction4));        \r\n\r\n        this.btn_restart.runAction(cc.sequence(cc.moveBy(0.2, cc.v2(320, 0)), this.lobbyAppearRestart));\r\n        this.btn_friend.runAction(cc.sequence(cc.moveBy(0.1, cc.v2(320, 0)), this.lobbyAppearFriend));\r\n        // this.game_successed = false;\r\n    },\r\n\r\n    callback_result_out: function()\r\n    {\r\n        this.result_pan.runAction(cc.sequence(\r\n            cc.moveBy(0.3, cc.v2(-320, 0)),\r\n            this.comeout_panAction, \r\n            cc.callFunc(this.restart_game.bind(this))\r\n        )); \r\n    },\r\n\r\n    restart_game: function()\r\n    {    \r\n        this.game_successed = false;\r\n        this.finished = false;  \r\n        this.clear_node();  \r\n        this.change_level(this.game_level);        \r\n        this.create_table();\r\n    },    \r\n\r\n    clear_node: function()\r\n    {\r\n        for (var row = 0; row < this.rows; row++) {            \r\n            for (var col = 0; col < this.rows; col++) {\r\n                this.node.removeChild(this.game_table[row][col].element);\r\n                this.game_table[row][col].element.destroy();\r\n                this.game_table[row][col].element = null;\r\n            }\r\n        }\r\n    },\r\n\r\n    reset_table: function()\r\n    {\r\n        this.numberToSpawn = this.rows * this.rows;        \r\n        this.start_table = {};        \r\n        for (var row = 0; row < this.rows; row++) {            \r\n            this.start_table[row] = {};            \r\n        }  \r\n\r\n        this.game_table = {};\r\n        for (var row = 0; row < this.rows; row++) {\r\n            this.game_table[row] = {};\r\n            for (var col = 0; col < this.rows; col++) {\r\n                this.game_table[row][col] = {\r\n                    colour: null,\r\n                    flooded: false,\r\n                    element: null\r\n                };\r\n            }\r\n        }\r\n    },\r\n\r\n    change_level: function (num)\r\n    {        \r\n        this.game_successed = false;\r\n        this.game_level = num;\r\n        this.rows = this.level[num].rows;\r\n        this.limit_moves = this.level[num].limit;\r\n        this.level_name = this.level[num].name;\r\n        this.moves = 0;\r\n        this.updateMoves();\r\n        this.mode_label.string = this.level_name;        \r\n        this.reset_table();  \r\n        this.setSpawnCordinate();     \r\n    },\r\n\r\n    random_colour: function  ()\r\n    {        \r\n        var colour_no = Math.floor (Math.random () * 6);\r\n        return this.colours[colour_no];\r\n    },    \r\n\r\n    flood_element: function (row, col, colour)\r\n    {\r\n        this.game_table[row][col].colour = colour;\r\n        this.game_table[row][col].element.color = colour;\r\n    },\r\n\r\n    flood_neighbours: function  (row, col, colour)\r\n    {\r\n        if (row < this.rows - 1)\r\n        this.test_colour_flood (row + 1, col, colour);\r\n        if (row > 0)\r\n        this.test_colour_flood (row - 1, col, colour);\r\n        if (col < this.rows - 1)\r\n        this.test_colour_flood (row, col + 1, colour);\r\n        if (col > 0)\r\n        this.test_colour_flood (row, col - 1, colour);\r\n    },\r\n\r\n    test_colour_flood: function  (row, col, colour)\r\n    {\r\n        if (this.game_table[row][col].flooded)\r\n            return;\r\n        if (this.game_table[row][col].colour.equals(colour)) {\r\n            this.game_table[row][col].flooded = true;\r\n            this.flood_neighbours (row, col, colour);\r\n        }\r\n    },\r\n\r\n    all_flooded: function  ()\r\n    {\r\n        for (var row = 0; row < this.rows; row++) {\r\n            for (var col = 0; col < this.rows; col++) {\r\n                if (! this.game_table[row][col].flooded) {\r\n                    return false;\r\n                }\r\n            }\r\n        }\r\n        return true;\r\n    },\r\n\r\n    flood: function(colour, initial)\r\n    {\r\n        if (this.finished)\r\n            return;\r\n        var old_colour = this.game_table[0][0].colour;\r\n        if (! initial && colour == old_colour)\r\n            return;\r\n        this.moves++;        \r\n        \r\n        for (var row = 0; row < this.rows; row++) \r\n            for (var col = 0; col < this.rows; col++) \r\n            {\r\n                if (this.game_table[row][col].flooded)\r\n                 {\r\n                    this.flood_element (row, col, colour);                    \r\n                 } \r\n            }      \r\n        for (var row = 0; row < this.rows; row++)\r\n            for (var col = 0; col < this.rows; col++)\r\n                if (this.game_table[row][col].flooded)\r\n                {\r\n                    this.flood_neighbours (row, col, colour);\r\n                }\r\n                \r\n        if (this.moves < this.limit_moves)\r\n        {\r\n            if (this.all_flooded ()) \r\n            {\r\n                this.finished = true;\r\n                this.game_successed = true;            \r\n                this.in_result_pan();\r\n            }\r\n        }\r\n        else\r\n            this.in_result_pan();       \r\n    },\r\n\r\n    create_table: function()\r\n    {\r\n        this.moves = -1;\r\n        this.finished = false;        \r\n        for (var row = 0; row < this.rows; row++) {            \r\n            for (var col = 0; col < this.rows; col++) \r\n            {        \r\n                var colour = this.random_colour();\r\n                this.game_table[row][col].colour = colour;\r\n                // this.start_table[row][col] = colour;\r\n                var star = this.spawnNewStarByNum(row, col, row, colour);                \r\n                this.game_table[row][col].element = star;\r\n                this.game_table[row][col].flooded = false;\r\n            }\r\n        }\r\n        this.game_table[0][0].flooded = true;\r\n        this.flood (this.game_table[0][0].colour, true);\r\n    },\r\n\r\n    setSpawnCordinate: function()\r\n    {         \r\n        for(var i = 0; i < this.rows; i++)\r\n            for(var j = 0; j <= i; j++)\r\n            {                 \r\n                this.spawnCount++;\r\n                this.start_table[i][j] = i -j + 1;\r\n            }\r\n        for(var i = 1; i < this.rows; i++)\r\n            for(var j = i; j < this.rows; j++)\r\n            {   \r\n                var inum = this.rows -j + i;     \r\n                this.spawnCount++; \r\n                this.start_table[i][j] = this.rows -j + i;\r\n            }\r\n\r\n            this.spawnCount = 0; \r\n    },\r\n\r\n    spawnNewStarByNum: function(i, j, inum, newcolour) {\r\n              \r\n        var newStar = cc.instantiate(this.floodPrefab);\r\n        var color = newStar.color;                \r\n        newStar.color = newcolour;\r\n        // this.node.addChild(newStar);\r\n        \r\n        var starWidth = (this.canvas.width - 2 * this.marginX) / this.rows;\r\n        newStar.width = starWidth;\r\n        newStar.height = starWidth;      \r\n\r\n        var x =  starWidth * inum - this.canvas.width / 2 + starWidth / 2 + this.marginX;\r\n        var y =  this.canvas.height / 2 - starWidth * j - starWidth / 2  - this.marginy;\r\n        var pos = cc.v2( x , y);\r\n        newStar.setPosition(pos);   \r\n        return newStar;   \r\n    },\r\n\r\n    spawnNewStar: function() \r\n    {        \r\n        if (this.spawnCount >= this.numberToSpawn) {\r\n            return;\r\n        }      \r\n        \r\n        // var newStar = cc.instantiate(this.floodPrefab);\r\n        // this.node.addChild(newStar);\r\n        // newStar.zIndex = 3;\r\n        // newStar.setPosition(this.getNewStarPosition(newStar.width));        \r\n        //newStar.setPosition(cc.v2(newStar.getPosition().x + newStar.node.width * i, 0)); \r\n\r\n        this.getNewStarPosition();\r\n        this.spawnCount++;\r\n    },\r\n\r\n    getNewStarPosition: function (starWidth) {\r\n\r\n        var i = this.spawnCount % this.rows;\r\n        var j = parseInt(this.spawnCount / this.rows);\r\n        var newStar = this.game_table[i][j].element;\r\n        // starWidth = star.width;\r\n        newStar.zIndex = 3;\r\n        this.node.addChild(newStar);\r\n        // this.marginX = (this.canvas.width - starWidth * this.numberToSpawn / this.rows ) / 2;\r\n        // this.marginy = (this.canvas.height - starWidth * this.numberToSpawn / this.rows ) / 2;\r\n        // var x =  starWidth * (this.spawnCount % this.rows) - this.canvas.width / 2 + starWidth / 2 + this.marginX;\r\n        // var ynum = (this.spawnCount - (this.spawnCount % this.rows)) * this.rows;\r\n        // var y =  this.canvas.height / 2 - starWidth * parseInt(this.spawnCount / this.rows) - starWidth / 2  - this.marginy;\r\n        \r\n        // var inum = this.start_table[i][j];\r\n                       \r\n        // cc.log(inum + \":\" + j);\r\n        // return star.position;\r\n        // return cc.v2( x , y);\r\n    },\r\n\r\n    new_game: function()\r\n    {\r\n        this.create_table();\r\n    },\r\n\r\n    updateMoves: function () {                \r\n        this.move_display.string = this.moves + \" / \" + this.limit_moves; \r\n    },\r\n\r\n    gainScore: function () {\r\n        // this.score += 1;        \r\n        // this.scoreDisplay.string = this.score;        \r\n        // cc.audioEngine.playEffect(this.scoreAudio, false);\r\n    },\r\n\r\n    gameOver: function () {\r\n        // this.player.stopAllActions(); \r\n        cc.director.loadScene('game');\r\n    }\r\n});\r\n"]}